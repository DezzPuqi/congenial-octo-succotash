<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Live Request Log</title>
<style>
  body { font-family: Arial, sans-serif; background: #f8f9fa; padding: 20px; }
  .card {
    background: white; padding: 20px; border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1); width: 420px;
  }
  #log {
    margin-top: 16px; padding: 10px; background: #eee;
    border-radius: 6px; height: 250px; overflow-y: auto; font-size: 14px;
  }
</style>
</head>
<body>

<div class="card">
  <h2>Live Request Log</h2>

  <div>Total Requests: <span id="total">0</span></div>

  <div class="status">Updating every 1s...</div>

  <div id="log"></div>
</div>

<script>
async function updateLog() {
  try {
    const res = await fetch("/api/logs");
    const data = await res.json();

    const logs = data.logs;

    document.getElementById("total").textContent = logs.length;

    const logBox = document.getElementById("log");
    logBox.innerHTML = "";

    logs.forEach(l => {
      const time = new Date(l.time).toLocaleTimeString();
      logBox.innerHTML += `[${time}] IP: ${l.ip} â€” Total: ${l.total}<br>`;
    });

    logBox.scrollTop = logBox.scrollHeight;

  } catch (err) {
    console.log("Log error:", err);
  }
}

// Ambil log setiap 1 detik
setInterval(updateLog, 1000);
updateLog();
</script>

</body>
</html>
